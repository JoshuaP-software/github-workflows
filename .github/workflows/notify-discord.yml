name: Notify Discord on PR events

on:
  pull_request:
    types: [opened, closed]
  workflow_call:
    secrets:
      DISCORD_WEBHOOK:
        required: true

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send PR opened message
        if: ${{ github.event.action == 'opened' }}
        uses: Ilshidur/action-discord@0.4.0
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        with:
          args: |
            ðŸ†• **Pull Request Opened**
            â€¢ **Title:** ${{ github.event.pull_request.title }}
            â€¢ **Author:** ${{ github.actor }}
            â€¢ **Link:** ${{ github.event.pull_request.html_url }}

      - name: Send PR merged message
        if: ${{ github.event.pull_request.merged == true }}
        uses: Ilshidur/action-discord@0.4.0
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        with:
          args: |
            âœ… **Pull Request Merged**
            â€¢ **Title:** ${{ github.event.pull_request.title }}
            â€¢ **Merged by:** ${{ github.actor }}
            â€¢ **Link:** ${{ github.event.pull_request.html_url }}
